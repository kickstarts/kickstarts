#!/usr/bin/env node

// =====================================================
// Dependencies
// =====================================================

const color    = require('ansi-colors')
const shell    = require('shelljs')
const program  = require('commander')
const Enquirer = require('enquirer')

const package  = require('../package.json')

const enquirer = new Enquirer()

const questions = [
  {
    type: 'input',
    name: 'folder',
    message: 'Your project name:'
  },
  {
    type: 'select',
    name: 'kickstart',
    message: 'Select a kickstart:',
    choices: [
      { name: 'react-kickstart', message: 'React JS', value: 'react-kickstart' },
      { name: 'rna-kickstart', message: 'React Native', value: 'rna-kickstart' },
      { name: 'ng-kickstart', message: 'AngularJS', value: 'ng-kickstart' },
      { name: 'ionic-kickstart', message: 'Ionic', value: 'ionic-kickstart' },
      { name: 'nestjs-kickstart', message: 'NestJS', value: 'nestjs-kickstart' },
      { name: 'wp-kickstart', message: 'WordPress', value: 'wp-kickstart' },
      { name: 'cli-tool-kickstart', message: 'CLI Tool', value: 'cli-tool-kickstart' },
      { name: 'sh-kickstart', message: 'Shell Script', value: 'sh-kickstart' }
    ]
  }
];


// =====================================================
// Initialize
// =====================================================

const initializeProgram = () => {

  const response = enquirer.prompt(questions);

  response.then(result => {
    let projectName = result.folder.toLowerCase().replace(' ', '-')
    shell.echo(color.cyan('→ Initializing...'))
    shell.exec(`git clone https://github.com/kickstarts/${result.kickstart} ${projectName}`)
    shell.echo(color.green('✔ All Done!'))
  })

}


// =====================================================
// CLI Commands
// =====================================================

// Version
program
  .version(color.cyan(`${package.name} - Version ${package.version}`), '-v, --version')
  .option('-s --silent', 'Skip status logged to the console')

// Main Command
program
  .command('start')
  .description('Create a Kickstart')
  .action(initializeProgram)

  // Help
program.on('-h, --help', () => {
  console.log('Help')
})

// Default
program.parse(process.argv)

if (process.argv.length === 2) {
  program.help()
}
